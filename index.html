<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Estilo futbol</title>
  <style>
    body { background: #1e1e2f; color: #ddd; font-family: sans-serif; margin: 0; padding: 1rem; }
    .tabs button { margin: 0.2em; padding: 0.5em 1em; background: #444; border: none; border-radius: 4px; color: #ddd; }
    .tabs button.selected { background: #005f99; }
    .tabs button:not(.selected):hover { background: #555; }
    .filters { display: flex; flex-wrap: wrap; gap: 0.5em; margin-bottom: 1em; }
    .filters button { padding: 0.4em 0.8em; background: #333; border: none; border-radius: 4px; color: #ddd; cursor: pointer; white-space: nowrap; }
    .filters button.selected { background: #005f99; }
    .filters button:not(.selected):hover { background: #444; }
    .match-table { width: 100%; border-collapse: collapse; margin-top: 1em; }
    .match-table th, .match-table td { padding: 0.5em; text-align: center; border-bottom: 1px solid #444; }
    .match-table th { background: #2a2a40; }
    .match-table td img { width: 20px; height: 20px; vertical-align: middle; margin-right: 0.4em; }
  </style>
</head>
<body>

  <h1>🌟 Estilo futbol 🌟</h1>

  <div class="tabs">
    <button id="btn-yesterday">Yesterday</button>
    <button id="btn-today" class="selected">Today</button>
    <button id="btn-tomorrow">Tomorrow</button>
  </div>

  <h2>Ligas & Copas</h2>
  <div class="filters" id="league-filters"></div>

  <div id="matches"></div>

  <script>
    const defaultLogo = 'https://via.placeholder.com/20?text=🏆';

    const tabs = {
      'yesterday': document.getElementById('btn-yesterday'),
      'today': document.getElementById('btn-today'),
      'tomorrow': document.getElementById('btn-tomorrow'),
    };
    let currentTab = 'today';

    Object.entries(tabs).forEach(([day, btn]) => {
      btn.addEventListener('click', () => {
        currentTab = day;
        Object.values(tabs).forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
        loadMatches();
      });
    });

    function getDateKey(offset) {
      const d = new Date();
      d.setUTCDate(d.getUTCDate() + offset);
      return d.toISOString().split('T')[0];
    }

    function loadMatches() {
      fetch('datos.json')
        .then(r => r.json())
        .then(data => {
          const dates = [getDateKey(-1), getDateKey(0), getDateKey(1)];
          const allMatches = dates.flatMap(d => data[d] || []);

          const leagues = {};
          allMatches.forEach(m => {
            const key = m.league.name;
            if (!leagues[key]) leagues[key] = m.league;
          });

          const filtersDiv = document.getElementById('league-filters');
          filtersDiv.innerHTML = '';
          Object.values(leagues).forEach(l => {
            const btn = document.createElement('button');
            btn.dataset.league = l.name;
            btn.className = 'selected';
            btn.textContent = l.name;
            btn.addEventListener('click', () => {
              btn.classList.toggle('selected');
              loadMatchList();
            });
            filtersDiv.appendChild(btn);
          });

          loadMatchList();

          function loadMatchList() {
            const date = currentTab === 'yesterday' ? getDateKey(-1)
                         : currentTab === 'tomorrow' ? getDateKey(1)
                         : getDateKey(0);

            const leagueSet = new Set(Array.from(document.querySelectorAll('#league-filters button.selected')).map(b => b.dataset.league));
            const matches = data[date] || [];
            const container = document.getElementById('matches');
            container.innerHTML = '';

            if (matches.length === 0) {
              container.innerHTML = '<p>No matches for this day.</p>';
              return;
            }

            const table = document.createElement('table');
            table.className = 'match-table';
            table.innerHTML = `
              <tr>
                <th>Local</th>
                <th>Hora</th>
                <th>Visitante</th>
              </tr>
            `;

            matches
              .filter(m => leagueSet.has(m.league.name))
              .forEach(m => {
                const row = document.createElement('tr');
                row.innerHTML = `
                  <td><img src="${m.teams.home.logo || defaultLogo}" onerror="this.src='${defaultLogo}'"> ${m.teams.home.name}</td>
                  <td>${new Date(m.fixture.date).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}</td>
                  <td><img src="${m.teams.away.logo || defaultLogo}" onerror="this.src='${defaultLogo}'"> ${m.teams.away.name}</td>
                `;
                table.appendChild(row);
              });

            container.appendChild(table);
          }
        });
    }

    loadMatches();
  </script>

</body>
</html>
